# defaults/main.yml
---


# Process Management
teleport_package: teleport
teleport_package_state: present
teleport_version: "{{ '15.4.11' if not teleport_autodetect_version }}"
teleport_edition: "oss"
teleport_autodetect_version: false
teleport_architecture: "amd64-bin"
teleport_url: "https://get.gravitational.com/teleport-v{{ teleport_version }}-linux-{{ teleport_architecture }}.tar.gz"
teleport_gpg_key_url: "https://rpm.releases.teleport.dev/RPM-GPG-KEY-teleport"
teleport_yum_baseurl: "https://yum.releases.teleport.dev"
teleport_repo_file: "/etc/yum.repos.d/teleport.repo"
teleport_channel: "stable/v17"
teleport_update: no
teleport_backup_config: true
teleport_create_config: true
teleport_ec2_join_token: ec2-teleport-join-token
teleport_config_path: "/etc/teleport.yaml"
teleport_config_template: "default_teleport.yaml.j2"
teleport_control_systemd: yes
teleport_template_config: yes
teleport_service_user: "teleport"
teleport_system_group: "teleport"
teleport_service_template: "teleport.service.j2"

# Core Configuration
teleport_config_dir: "/etc/teleport"
teleport_cluster_name: ""
teleport_nodename: "{{ inventory_hostname }}"
teleport_proxy_server: ""
teleport_proxy_port: 443
teleport_fetch_ca_pin: true
teleport_ca_pin: ""
teleport_change_ca_pin: false
teleport_auth_token: ""
teleport_log_severity: "INFO"
teleport_diag_addr: ""
teleport_join_token_ttl: "1h"
teleport_csr_path: "/etc/teleport/tls/teleport.csr"
teleport_tls_country: "BR"
teleport_tls_state: "São Paulo"
teleport_tls_locality: "São Paulo"
teleport_tls_organization: "Datacosmos"
teleport_tls_valid_days: 365
teleport_tls_sans: []
# Exemplo:
# teleport_tls_sans:
#   - "teleport.example.com"
#   - "cluster.example.com"
teleport_validate_certs: true

# Services Configuration
teleport_labels_injetct_realhostname:
teleport_labels:
  - key: "real_hostname"
    value: "{{ ansible_fqdn }}"

# SSH Service
teleport_ssh_enabled: true
# SSH service listen address.
# For example, "0.0.0.0:3022" listens on all interfaces at port 3022.
teleport_ssh_listen_addr: "0.0.0.0:3022"
# Default login allowed for SSH access.
# Typically "root" or another user based on your access policy.
teleport_ssh_default_login: '' # "root"
# Additional allowed SSH logins.
# Provide a list of usernames to allow besides the default login.
# Example: ["admin", "ubuntu"]
teleport_ssh_additional_logins: []
#  - "admin"
#  - "ubuntu"
# SSH-specific labels.
# Define a list of key/value pairs to tag the SSH service.
# Example:
#   - key: "role"
#     value: "ssh"
#   - key: "department"
#     value: "IT"
teleport_ssh_labels: []
#  - key: "role"
#    value: "ssh"
#  - key: "department"
#    value: "IT"
# Custom SSH commands available via Teleport.
# Provide a list of commands (as strings) that users can execute.
# Example: ["uptime", "free -m"]
teleport_ssh_commands: []
#  - "uptime"
#  - "free -m"
# SSH session recording settings.
# Enable session recording if true.
teleport_ssh_session_recording: true
# Mode for session recording: "node" (recorded at the node) or "proxy" (recorded at the proxy).
teleport_ssh_session_mode: "node"  # Example: "node"
# SSH session timeout.
# Specify a timeout value, e.g., "30s" for 30 seconds.
teleport_ssh_timeout: "30s"
# Public keys to inject for SSH access.
# Provide a list of SSH public keys.
# Example:
#   - "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC1EXAMPLEKEY user@example.com"
teleport_ssh_pub_keys: []

# Proxy Service
teleport_proxy_enabled: false
teleport_proxy_labels: []
teleport_proxy_tls_dir: "/etc/teleport/tls"
teleport_proxy_tls_cert: "{{ teleport_proxy_tls_dir }}/teleport.crt"
teleport_proxy_tls_key: "{{ teleport_proxy_tls_dir }}/teleport.key"
teleport_proxy_acme_email: "security@example.com"

# Kubernetes Service
teleport_kube_enabled: false
teleport_kube_labels: []
teleport_kube_clusters: []
  # ex:
  # - name: "prod-cluster"
  #   labels:
  #     env: "prod"
  #     region: "us-east1"

# Database Service
teleport_db_enabled: false
teleport_db_labels: []
teleport_db_databases: []
  # ex:
  # - name: "postgres-prod"
  #   protocol: "postgres"
  #   uri: "db-prod.internal:5432"
  #   labels:
  #     tier: "database"

teleport_apps_enabled: false
teleport_apps_labels: []
teleport_apps: []
  # - name: "webapp"
  #   uri: "http://localhost:8080"
  #   labels:
  #     type: "http"
  #     framework: "django"

# Windows Desktop Service
teleport_windows_desktop_enabled: false
teleport_windows_labels: []
teleport_windows_hosts: []
  # ex:
  # - "desktop01.example.com"
  # - "192.168.1.100"
